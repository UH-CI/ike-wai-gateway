<!--
<div class="page-bar">
    <ul class="page-breadcrumb">
        <li>
            <a href="#/dashboard.html">Home</a>
            <i class="fa fa-circle"></i>
        </li>
        <li>
            <a href="#/metadata">Metadata</a>
            <i class="fa fa-circle"></i>
        </li>
        <li>
            <a href="#/filemetadata/{{filemetadatumUuid}}">File Metadata</a>
        </li>
    </ul>
    <div landing-start-menu></div>
</div>
 -->
<style>
.btn-circle {
  width: 15px;
  height: 15px;
  text-align: center;
  padding: 0 0;
  font-size: 11px;
  line-height: .514;
  border-radius: 5px;
}
.btn-circle.btn-lg {
  width: 50px;
  height: 50px;
  padding: 10px 16px;
  font-size: 18px;
  line-height: 1.33;
  border-radius: 25px;
}
.btn-circle.btn-xl {
  width: 70px;
  height: 70px;
  padding: 10px 16px;
  font-size: 24px;
  line-height: 1.33;
  border-radius: 35px;
}
.form-group.required .control-label:after {
  content:"*";
  color:red;
}
</style>


<script type="text/javascript">
      $(document).ready(function() {
          $('#datetimepicker1').datepicker({
            format: 'yyyy-mm-dd',
            todayHighlight: true,
            autoClose: true,
            //useCurrent: false,
            validateOnBlur: false,
            allowInputToggle : true,
            forceParse: false
          // if selected start date is before current end date, make end date match start date
          }).on("changeDate", function(e) {
              var d1 = $('#datetimepicker1').datepicker("getDate");
              var d2 = $('#datetimepicker2').datepicker("getDate");
              if (d2 < d1) {
                $('#datetimepicker2').datepicker("setDate", e.date);
              }
          });
          $('#datetimepicker2').datepicker({
            format: 'yyyy-mm-dd',
            todayHighlight: true,
            autoClose: true,
            //useCurrent: false,
            validateOnBlur: false,
            allowInputToggle : true,
            forceParse: false
          // if selected end date is before current start date, make start date match end date
          }).on("changeDate", function(e) {
              var d1 = $('#datetimepicker1').datepicker("getDate");
              var d2 = $('#datetimepicker2').datepicker("getDate");
              if (d2 < d1) {
                $('#datetimepicker1').datepicker("setDate", e.date);
              }
          });
          $('#datetimepicker3').datepicker({
            format: 'yyyy-mm-dd',
            todayHighlight: true,
            autoClose: true,
            //useCurrent: false,
            validateOnBlur: false,
            allowInputToggle : true,
            forceParse: false
          });
      });
</script>


<!--<h4><a ng-click="doTheBack()"><i class="glyphicon glyphicon-menu-left"/>Go Back</a></h4>-->
<div id="data_descriptor_modal" class='modal-header'>
  
  <div class="row">
    <div class="col-md-12">
      <div class="portlet light portlet-fit portlet-datatable ">
        <h3 class="modal-title">Data Descriptor
          <button class="btn pull-right" ng-click="close()">X</button>
        </h3>
        <h4 class align="center" ng-if="!wizardSecondPage && !has_data_descriptor">Step 1 of 2</h4>
        <h4 class align="center" ng-if="wizardSecondPage">Step 2 of 2</h4>
        <div>
          <br />
          <b>Associated Files:</b>
          <table>
            <tbody>
              <tr ng-repeat="link in data_descriptor_metadatum._links.associationIds">
                <td ng-if="link.title == 'file'">
                  <!--<a href="#/data/explorer/{{link.href.split('system')[1]}}"><i class="fa fa-file-o">{{link.href.split('system')[1]}}</i></a>-->
                  {{link.href.split('system')[1]}}  <div ng-show="edit_data_descriptor"><button type="button" class="btn btn-success text-center"  ng-click="unAssociateMetadata([link.rel])"><i class="fa fa-trash"></i> {{"Remove Association" | translate}}</button></div>
                  <td ng-show="link.href.includes('ikewai-annotated-data')">
                      <button type="button" class="btn btn-success text-center"  ng-click="download([link.href])"><i class="fa fa-download"></i> {{"Download" | translate}}</button>
                    </td>
                </td>
              </tr>
            </tbody>  
          </table>
        </div>
        
        <div ng-show='public_file_urls.length > 0'>
          <br />
          <b>Public File Links:</b>
          <table>
            <tbody>
              <tr ng-repeat="url in public_file_urls">
                <td>
                  <a href="{{url}}">{{url}}</a>
                </td>
              </tr>
            </tbody>  
          </table>
        </div>

        <div ng-show='data_descriptor_metadatum.value.hydroshareResourceId'>
          <br />
          <b>Hydroshare Resource URL: </b><a href="https://www.hydroshare.org/resource/{{data_descriptor_metadatum.value.hydroshareResourceId}}">https://www.hydroshare.org/resource/{{data_descriptor_metadatum.value.hydroshareResourceId}}</a>
        </div>
        <div ng-show='data_descriptor_metadatum.value.doi'>
          <br />
          <b>Hydroshare DOI URL: </b><a href="https://doi.org/10.4211/hs.{{data_descriptor_metadatum.value.hydroshareResourceId}}">https://doi.org/10.4211/hs.{{data_descriptor_metadatum.value.hydroshareResourceId}}</a>
        </div>

      </div>
    </div>
  </div>
  <!-- warning shows here -->
</div>
<div class="row">
    <div class="col-md-12">
      <!-- 
      JG TODO: check push status, if true, add a message at the top telling user this is their last chance,
      highlight any unfilled fields, and add a section where they choose which files to push.
      -->
      <div class="panel panel-default"  ng-show="push_data_descriptor">
          <div class="panel-heading" align="center"><b>Push to Hydroshare and ikewai.org</b></div>
          <div class="panel-body">
            <div class="form-group">
              
                <label class="control-label pull-left">
                  1.) Please make sure everything is completely filled out before submitting to Hydroshare.
                  Once submitted, the data will be immutable.<br />
                  2.) Pay particular attention to the fields in the "Hydroshare" section of the form 
                  (visible in edit mode, consists of license rights, contributors, and related resources).<br />
                  3.) Make sure your authors are in the order you want them to appear.<br />
                  3.) Note that anything pushed to Hydroshare will also be automatically pushed to ikewai.org.
                  <!--3.) Finally, select the files you want included in your submission and click the "Push" button.
                  Note that only files that have been pushed to the `Ike wai annotated repository will be available
                  for selection.  Also, anything pushed to Hydroshare will also be submitted to ikewai.org.-->
                </label>
                <div class="input-group">
                  <!-- TODO: this doesn't work, just leave it for now and add as a future feature -->
                  <!--
                  <table class="table table-striped table-bordered">
                    <tbody>
                      <th>Select the files to be included in the Hydroshare and ikewai.org submission: </th>
                      <tr ng-repeat="link in data_descriptor_metadatum._links.associationIds">
                        <td ng-if="link.title == 'file'" ng-show="link.href.includes('ikewai-annotated-data')"> 
                          <input type="checkbox" ng-model="datadescriptor.selected_push_files" ng-true-value="[link.href]">
                            {{link.href.split('system')[1]}}
                          </input>
                        </td> 
                      </tr>
                    </tbody>
                  </table>
                   -->
                  <button type="button" ng-if="pushLocation == 'ikewai'" class="btn btn-success text-center"  ng-click="stageToIkewai()"><i class="fa fa-plus"></i> {{"Stage to Ikewai" | translate}}</button>
                  <button type="button" ng-if="pushLocation == 'hydroshare'" class="btn btn-success text-center"  ng-click="stageToHydroshare()"><i class="fa fa-plus"></i> {{"Stage to Hydroshare" | translate}}</button>
              </div>
            </div>
          </div>
        </div>
    </div>
</div>
<div class="row">
    <div class="col-md-12">
        <div class="portlet light portlet-fit portlet-datatable bordered">

            <!--
            <div class="portlet-title">
                <div class="row text-center">
                  <div class="col-md-12">

                  </div>
                </div>
                <div ng-controller="MetadataQueryBuilderCtrl" class="text-center top-buffer" ng-keyup="$event.keyCode == 13 ? searchTools(query) : null">
                    <div class="btn-group top-buffer">
                      <div class="input-group">
                        <div class="input-group-addon"><i class="fa fa-filter" aria-hidden="true"></i></div>
                        <input type="text" class="form-control" placeholder="Filter" ng-model="$parent.filter">
                      </div>
                    </div>
                    <div class="row top-buffer" ng-show="showSearch">
                      <query-builder group="filter.group" resource="metadata"></query-builder>
                      <div class="col-md-12 top-buffer">

                        <div class="input-group">
                          <div class="input-group-addon"><i class="fa fa-search" aria-hidden="true"></i></div>
                          <input type="text" class="form-control" placeholder="Search" ng-model="query">
                        </div>

                        <div class="btn-group">
                          <button class="btn btn-success top-buffer" ng-click="searchTools(query)">Search</button>
                        </div>
                      </div>
                    </div>
                    <div class="btn-group top-buffer">
                      <button class="btn btn-default" ng-click="showSearch = !showSearch">
                        <i class="fa fa-search"></i> {{showSearch ? 'Hide Tools' : 'Search Tools'}}
                      </button>
                    </div>
                </div>
            </div>
            -->
            <div class="portlet-body">
              <div class="row text-center" ng-show="requesting">
                  <div class="col-md-12">
                    <div class="loading-message"><div class="block-spinner-bar"><div class="bounce1"></div><div class="bounce2"></div><div class="bounce3"></div></div></div>
                  </div>
              </div>

              <div class="row">
                <div class=" pull-left">
                  <h4>{{filename.split('/').pop()}}</h4>
                </div>
                <div ng-show='edit_perm || !data_descriptor_metadatum.value.published' class="pull-right" ng-if="has_data_descriptor == true && edit_data_descriptor == false">
                  <a class="btn btn-default" href="#" ng-click="editDataDescriptor()"><i class="fa fa-pencil"/> Edit Annotations</a>
                </div>
                <div ng-show='edit_perm || !data_descriptor_metadatum.value.published' class="pull-right" ng-if="has_data_descriptor == true && edit_data_descriptor == false">
                    <a class="btn btn-default" href="#" ng-click="exportDataDescriptor()"><i class="fa fa-pencil"/> Export to text file</a>
                  </div>
                <div class="pull-right" ng-show="!wizardSecondPage" ng-if="has_data_descriptor == true && edit_data_descriptor == true">
                  <a class="btn btn-default" href="#" ng-click="cancelEditDataDescriptor()"><i class="fa fa-pencil"/> Cancel Editing Without Saving</a>
                </div>


                <!--  DATA DESCRIPTOR DISPLAY/VIEW (NOT EDIT) FORM -->
                  <div class="col-md-12">
                    <div ng-show="!requesting">
                      <div ng-show="has_data_descriptor == true && edit_data_descriptor == false;">
                          <div>
                            <div ng-if="data_descriptor_metadatum" class="portlet light table-responsive">
                              <table class="table table-striped table-bordered">
                                <tbody>
                                  <tr ng-if="key!=='publisher' 
                                            && key!=='version' 
                                            && key!='publication_date' 
                                            && key!='languages' 
                                            && (data_descriptor_metadatum.value[key].length > 0)"
                                      ng-repeat="(ind, key) in data_descriptor_order">
                                    <td width='30%'>
                                      <label class="control-label pull-left" for='{{key}}' data-toggle="tooltip" title='{{key | translate}}'>{{data_descriptor_display[ind]}}</label>
                                      <!--<button type="button" data-toggle="popover" title="" data-content='{{key| translate}}' class="btn btn-info btn-circle pull-left">
                                        <i class="glyphicon glyphicon-question-sign"></i>
                                      </button>-->
                                    </td>
                                    <td ng-if="key=='creators' ">
                                      <span class="btn btn-default" ng-repeat="(key, val) in data_descriptor_metadatum.value[key]" ng-click="openViewMetadata(val.uuid, 'lg')">
                                        {{val.first_name}} {{val.last_name}}
                                      <span>
                                    </td>
                                    <td ng-if="key=='newspapers'">
                                        <span class="btn btn-default" ng-repeat="(key, val) in data_descriptor_metadatum.value[key]" ng-click="openViewMetadata(val.uuid, 'lg')">
                                            {{val.name}}  
                                        <span>
                                    </td>
                                    <td ng-if="key=='articleAuthors'">
                                        <span class="btn btn-default" ng-repeat="(key, val) in data_descriptor_metadatum.value[key]" ng-click="openViewMetadata(val.uuid, 'lg')">
                                          {{val.name}} {{val.pen_name}}
                                        <span>
                                    </td>
                                    <td ng-if="key=='translators'">
                                        <span class="btn btn-default" ng-repeat="(key, val) in data_descriptor_metadatum.value[key]" ng-click="openViewMetadata(val.uuid, 'lg')">
                                            {{val.first_name}} {{val.last_name}}
                                        <span>
                                    </td>
                                   <td ng-if="key=='organizations'">
                                      <span class="btn btn-default" ng-repeat="(key, val) in data_descriptor_metadatum.value[key]" ng-click="openViewMetadata(val.uuid, 'lg')">
                                        {{val.name}}
                                      <span>
                                    </td>      
                                    <td ng-if="key=='contributors' ">
                                        <span class="btn btn-default" ng-repeat="(key, val) in data_descriptor_metadatum.value[key]" ng-click="openViewMetadata(val.uuid, 'lg')">
                                          {{val.first_name}} {{val.last_name}}
                                        <span>
                                    </td>                         
                                    <!--
                                    <td ng-if="key=='subjects' ">
                                      <span class="btn btn-default" ng-repeat="(key, val) in data_descriptor_metadatum.value[key]" ng-click="openViewMetadata(val.uuid, 'lg')">
                                        {{val.word}}
                                      <span>
                                    </td>
                                    -->
                                    <td ng-if="key=='subjects' || key=='formats' || key=='data_types' || key=='data_states'">
                                    <!--<td ng-if="key=='subjects' || key=='formats' || key=='languages' ">-->
                                    <!--<td ng-if="key=='formats' || key=='languages' ">-->
                                      {{data_descriptor_metadatum.value[key].join(', ')}}
                                    </td>
                                    <td ng-if="key=='title' || key=='start_datetime' || key=='end_datetime' || key=='description' || key=='sensitive' || key==='publication_date' || key==='license_rights' || key==='relations' || key==='published' || key==='pushedToIkewai' || key==='pushedToHydroshare' || key==='stagedToIkewai' || key==='stagedToHydroshare'">
                                    <!--<td ng-if="key=='subjects' || key=='formats' || key=='languages' ">-->
                                    <!--<td ng-if="key=='formats' || key=='languages' ">-->
                                      {{data_descriptor_metadatum.value[key]}}
                                    </td>
                                    <!--<td ng-if="key !='creators' &&  key!='contributors'&& key!='organizations' &&key!='subjects' && key!='formats' && key!='languages'&& key!='publishers'">-->
                                    <!--<td ng-if="key !='creators' &&  key!='contributors'&& key!='organizations' && key!='subjects' && key!='formats' && key!='languages' && key!='start_datetime' && key!='end_datetime' && key!='publication_date'">
                                      {{data_descriptor_metadatum.value[key]}}
                                    </td>-->
                                  </tr>
                                </tbody>
                              </table>
                            </div>
                            <!-- CHOOSE LOCATIONS -->
                            <leaflet id="datadescriptorMap" defaults="defaults" width="100%" height="360px" center="hawaii"  markers="data_descriptor_markers" layers="layers" event-broadcast="events"></leaflet>
                            <div class="form-group" >
                              <button type="button" ng-show='(profile.username == data_descriptor_metadatum.owner && data_descriptor_metadatum.value.published!="True") || edit_perm ' class="btn btn-success pull-left form-control" ng-click="openLocations('lg' ,['Well','Site','Water_Quality_Site','RainfallStation'],'Select Location(s)')"><i class="glyphicon glyphicon-plus"></i> Add Additional Locations</button>
                              <h3 ng-show='data_descriptor_metadatum.value.published && !edit_perm'>Locations:</h3>
                            </div>
                            <div>
                              <table class="table table-striped table-bordered table-hover management">
                                <tbody>
                                  <tr class="" ng-repeat="filemetadatum in locations">
                                    <td>  <a href='#' ng-click="openViewMetadata(filemetadatum.uuid, 'lg')">    <i class="glyphicon glyphicon-eye-open"></i>{{filemetadatum.value.well_name}}{{filemetadatum.value.name}}{{filemetadatum.value.title}}
                                          {{filemetadatum.value.wid}} {{filemetadatum.value.variable_name}} {{filemetadatum.value.description}} {{filemetadatum.value.tags.toString()}}
                                          </a>
                                    </td>
                                    <td><span ng-show='(profile.username == data_descriptor_metadatum.owner && data_descriptor_metadatum.value.published!="True") || edit_perm'>
                                                  <!-- <a ui-sref="metadata-edit({uuid:filemetadatum.uuid})" role="button"> <i class="fa fa-pencil"></i> Edit </a> -->
                                                  <span ng-show='(profile.username == filemetadatum.owner) && filemetadatum.value.published!="True"'> <a href='#' ng-click="openEditMetadata(filemetadatum.uuid,'lg')" role="button"> <i class="fa fa-pencil"></i>Edit</a>
                                                |</span><a href="#" ng-click="unAssociateMetadata(filemetadatum.uuid)"><i class="glyphicon glyphicon-remove-sign"></i>Remove  </a></span></td>
                                  </tr>
                                </tbody>
                              </table>
                            </div></br>

                            <!-- CHOOSE VARIABLES -->
                            <div class="form-group">
                              <button ng-show='(profile.username == data_descriptor_metadatum.owner
                                                && data_descriptor_metadatum.value.published!="True")
                                                || edit_perm '
                                type="button"
                                class="btn btn-success pull-left form-control"
                                ng-click="openVariables('lg',['Variable'],'Select Variable(s)')">
                                  <i class="glyphicon glyphicon-plus"></i> Add Additional Variables
                              </button>
                              <h3 ng-show='data_descriptor_metadatum.value.published && !edit_perm'>Variables:</h3>
                            </div>
                            <div>
                              <table class="table table-striped table-bordered table-hover management">
                                <tbody>
                                  <tr class="" ng-repeat="filemetadatum in variables">
                                    <td>  <a href='#' ng-click="openViewMetadata(filemetadatum.uuid, 'lg')">    <i class="glyphicon glyphicon-eye-open"></i>{{filemetadatum.value.well_name}}{{filemetadatum.value.title}}
                                          {{filemetadatum.value.wid}} {{filemetadatum.value.variable_name}} {{filemetadatum.value.description}} {{filemetadatum.value.tags.toString()}}
                                          </a>
                                    </td>
                                    <td><span ng-show='(profile.username == data_descriptor_metadatum.owner && data_descriptor_metadatum.value.published!="True") || edit_perm'>
                                                  <!-- <a ui-sref="metadata-edit({uuid:filemetadatum.uuid})" role="button"> <i class="fa fa-pencil"></i> Edit </a> -->
                                                 <span ng-show='(profile.username == filemetadatum.owner) && filemetadatum.value.published!="True"'> <a href='#' ng-click="openEditMetadata(filemetadatum.uuid,'lg')" role="button"> <i class="fa fa-pencil"></i>Edit</a> |</span>
                                                <a href="#" ng-click="unAssociateMetadata(filemetadatum.uuid)"<i class="glyphicon glyphicon-remove-sign"></i>Remove  </a></span></td>
                                  </tr>
                                </tbody>
                              </table>
                            </div></br>
                          </div>
                      </div>

                      <!--DATA DESCRIPTOR EDIT FORM -->
                      <div ng-show="has_data_descriptor == false || edit_data_descriptor == true" class="text-center">
                        <!--
                        <div class="row ">
                          <div class="col-md-12">
                          <h3 class="pull-left">{{action | capitalize}} Data Descriptor </h3>
                        </div>
                       -->
                        <div class="col-md-11">
                          <form novalidate class="simple-form" name="dataDescriptorForm">

                            <!-- TITLE -->
                          <div class="panel panel-default"  ng-show="!wizardSecondPage">
                           <div class="panel-heading">Required</div>
                           <div class="panel-body">
                            <div class="form-group required">
                              <label class="control-label pull-left" for="title" data-toggle="tooltip" title='{{"title" | translate}}'>Title:</label>
                              <button type="button"  data-toggle="popover" title="Title Field" data-content='{{"title" | translate}}' class="btn btn-info btn-circle pull-left">
                                <i class="glyphicon glyphicon-question-sign"></i>
                              </button>
                              <span ng-show="missing_values_error" class="warning" autofocus>Title is a required field.</span>
                              <input class="form-control" type="text" ng-model="datadescriptor.title" />
                            </div>

                            <!-- AUTHOR -->
                            <div class="form-group required"  ng-show="!wizardSecondPage">
                              <label class="control-label pull-left" for="creator" data-toggle="tooltip" title='{{"creator" | translate}}'>Author(s):</label>
                              <button type="button" data-toggle="popover" title="Author Field" data-content='{{"creator" | translate}}' class="btn btn-info btn-circle pull-left">
                                <i class="glyphicon glyphicon-question-sign"></i>
                              </button>
                              <br />
                              <ui-select
                                class="form-control"
                                multiple
                                remove-selected="false"
                                ng-model="datadescriptor.creators"
                                theme="bootstrap"
                                style="width: 100%;text-align: left;"
                                sortable="true"
                                ng-disabled="disabled"
                                title="Choose creators">
                                <ui-select-match placeholder="Select author(s)...">{{$item.last_name}}, {{$item.first_name}}</ui-select-match>
                                <ui-select-choices repeat="person in people | filter: $select.search | orderBy:'last_name'">
                                  <div><span ng-bind-html="person.last_name"></span>, <span ng-bind-html="person.first_name"></span></div>
                                </ui-select-choices>
                              </ui-select>
							                <button type="button" class="fa fa-plus pull-right btn btn-default" ng-click="openCreatePerson('lg')">Create New Author</button>
                              <script>
                                 $(document).ready(function(){
                                     $('[data-toggle="popover"]').popover();
                                 });
                               </script>
                            </div>
                            <!--STATUS: options for file status (raw, processed, preliminary, final) -->
                            <div class="form-group required"  ng-show="!wizardSecondPage" align="left">


                              <label class="control-label" for="data_state" data-toggle="tooltip" title='{{"data_state" | translate}}'>Data State(s):</label>
                              <button type="button" data-toggle="popover" title="Data State Field" data-content='{{"data_state" | translate}}' class="btn btn-info btn-circle">
                                  <i class="glyphicon glyphicon-question-sign"></i>
                                </button>
                              <br />
                              <ui-select class="form-control"
                                multiple tagging tagging-label=""
                                remove-selected="false"
                                ng-model="datadescriptor.data_states"
                                theme="bootstrap"
                                style="width: 100%;text-align: left;"
                                sortable="true"
                                ng-disabled="disabled"
                                title="Choose data states">
                                <ui-select-match placeholder="Select file data state(s)...">{{$item}}</ui-select-match>
                                <ui-select-choices repeat="data_state in data_states | filter: $select.search">
                                  <span ng-bind-html="data_state"></span>
                                </ui-select-choices>
                              </ui-select>
                            
                            </div><br />
                            <!--
                              0 Raw (unedited) data, such as the output from a sensor
                              1 Data that have passed some objective quality assurance procedure (edited data)
                              2 Derived product, potentially from multiple sensors, that require some subjective judgment
                              (e.g., inference of a basin average precipitation from multiple rain gages)
                              3 Interpreted product, requiring more assumptions and judgments (e.g., rainfall inferred from
                              radar reflectance)
                              4 Knowledge product, requiring inferences, potentially from multiple disciplines, and
                              combining multiple measurements, each with their own assumptions (e.g., proportion of
                              “new” and “old” water in streamflow inferred from stable isotopes)
                              -9999 Unknown
                            -->
                            </div>
                      </div>
                      </br>

                      <!-- CONTRIBUTING AGENCIES -->
                      <div class="form-group"  ng-show="!wizardSecondPage">
                          <label class="control-label pull-left" for="contributorAgency" data-toggle="tooltip" title='{{"contributorAgency" | translate}}'>Contributor - Agency:</label>
                          <button type="button" data-toggle="popover" title="Contributing Agency Field" data-content='{{"contributorAgency" | translate}}' class="btn btn-info btn-circle pull-left">
                            <i class="glyphicon glyphicon-question-sign"></i>
                          </button>
                          <br />

                          <ui-select
                            class="form-control"
                            multiple
                            remove-selected="false"
                            ng-model="datadescriptor.organizations"
                            theme="bootstrap"
                            style="width: 100%;text-align: left;"
                            sortable="true"
                            ng-disabled="disabled"
                            title="Choose contributing people">
                            <ui-select-match placeholder="Select contributing organizations...">{{$item.name}}</ui-select-match>
                            <ui-select-choices repeat="org in orgs | filter: $select.search | orderBy:'name'">
                              <span ng-bind-html="org.name"></span>
                            </ui-select-choices>
                          </ui-select>
                          <button type="button" class="fa fa-plus pull-right btn btn-default" ng-click="openCreateOrg('lg')">Add Contributing Organizations</button>

                      </div>
                      <br />

                      <!-- CONTRIBUTING PERSON -->
                      <!--
                      <div class="form-group">
                          <label class="control-label pull-left" for="contributorPerson" data-toggle="tooltip" title='{{"contributorPerson" | translate}}'>Contributor - Person:</label>
                          <button type="button" data-toggle="popover" title="Contributing Person(s)" data-content='{{"contributorPerson" | translate}}' class="btn btn-info btn-circle pull-left">
                            <i class="glyphicon glyphicon-question-sign"></i>
                          </button>
                          <br />
                          <ui-select
                            class="form-control"
                            multiple
                            remove-selected="false"
                            ng-model="datadescriptor.contributors"
                            theme="bootstrap"
                            style="width: 100%;text-align: left;"
                            sortable="true"
                            ng-disabled="disabled"
                            title="Choose contributing people">
                            <ui-select-match placeholder="Select contributing people...">{{$item.last_name}}, {{$item.first_name}}</ui-select-match>
                            <ui-select-choices repeat="person in people | filter: $select.search | orderBy:'last_name'">
                              <span ng-bind-html="person.last_name"></span>, <span ng-bind-html="person.first_name">
                            </ui-select-choices>
                          </ui-select>
  
                          <button type="button" class="fa fa-plus pull-right btn btn-default" ng-click="openCreateContribPerson('lg')">Add Contributing People</button>
                        </div>
                        <br />
                        <br />
                        --->
                      <div class="panel panel-default"  ng-show="!wizardSecondPage">
                        <div class="panel-heading"><button class="btn btn-block" data-toggle="collapse" data-target="#hydroshare">Fields for Hydroshare</button></div>
                        <div id="hydroshare" class="panel-body collapse">
                         <div class="form-group">
                            <!-- CONTRIBUTING PERSON -->
                            <div class="form-group">
                                <label class="control-label pull-left" for="contributorPerson" data-toggle="tooltip" title='{{"contributorPerson" | translate}}'>Contributor - Person:</label>
                                <button type="button" data-toggle="popover" title="Contributing Person(s)" data-content='{{"contributorPerson" | translate}}' class="btn btn-info btn-circle pull-left">
                                  <i class="glyphicon glyphicon-question-sign"></i>
                                </button>
                                <br />
                                <ui-select
                                  class="form-control"
                                  multiple
                                  remove-selected="false"
                                  ng-model="datadescriptor.contributors"
                                  theme="bootstrap"
                                  style="width: 100%;text-align: left;"
                                  sortable="true"
                                  ng-disabled="disabled"
                                  title="Choose contributing people">
                                  <ui-select-match placeholder="Select contributing people...">{{$item.last_name}}, {{$item.first_name}}</ui-select-match>
                                  <ui-select-choices repeat="person in people | filter: $select.search | orderBy:'last_name'">
                                    <span ng-bind-html="person.last_name"></span>, <span ng-bind-html="person.first_name">
                                  </ui-select-choices>
                                </ui-select>
        
                                <button type="button" class="fa fa-plus pull-right btn btn-default" ng-click="openCreateContribPerson('lg')">Add Contributing People</button>
                            </div>
                            <br />
                            <br />

                            <!-- RELATED RESOURCES -->
                            <div class="form-group">
                              <label class="control-label pull-left" for="relations" data-toggle="tooltip" title='{{"relations" | translate}}'>Related Resources:</label>
                              <button type="button" data-toggle="popover" title="Related Resources" data-content='{{"relations" | translate}}' class="btn btn-info btn-circle pull-left">
                                <i class="glyphicon glyphicon-question-sign"></i>
                              </button>
                              <input ng-model="datadescriptor.relations" placeholder="Enter filenames linked to this resource" class="form-control" type='textarea' rows="2"/>
                            </div>

                            <!-- RIGHTS - LICENSE -->
                            <div class="form-group required">
                              <label class="control-label pull-left" for="rightsLicense" data-toggle="tooltip" title='{{"rightsLicense" | translate}}'>License - Rights:</label>
                              <button type="button" data-toggle="popover" title="License Rights Field" data-content='{{"rightsLicense" | translate}}' class="btn btn-info btn-circle pull-left">
                                <i class="glyphicon glyphicon-question-sign"></i>
                              </button>
                              <br />
                              <ui-select
                                ng-model="datadescriptor.license_rights"
                                theme="bootstrap"
                                style="width: 100%;text-align: left;">
                                  <ui-select-match placeholder="Select license...">{{$select.selected}}</ui-select-match>
                                  <ui-select-choices repeat="license in license_rights | filter: $select.search">
                                    <div ng-bind-html="license | highlight: $select.search"></div>
                                  </ui-select-choices>
                              </ui-select>
                            </div>

                            <!-- ACCESS RIGHTS -->
                            <!-- <div class="form-group required">
                              <label class="control-label pull-left" for="rightsPermissions" data-toggle="tooltip" title='{{"rightsPermissions" | translate}}'>Access Rights:</label>
                              <button type="button" data-toggle="popover" title="Access Rights Field" data-content='{{"rightsPermissions" | translate}}' class="btn btn-info btn-circle pull-left">
                                <i class="glyphicon glyphicon-question-sign"></i>
                              </button>
                              <br />
                              <br />
                                <label class="pull-left" >
                                  <input type="radio" ng-model="datadescriptor.license_permission" value="private">
                                  Private
                                </label>
                                <label class="pull-left" >
                                  <input  type="radio" ng-model="datadescriptor.license_permission" value="public" checked>
                                  Public
                                </label> -->
                                <!--<tt>color = {{datadescriptor.license_permission | json}}</tt><br/>-->

                              <!--
                              <div class="btn-group pull-left" role="group">
                                <button id="btn-public" data-toggle="tooltip" data-placement="auto"
                                    title='{{"rightsPermissionsPublic" | translate}}' class="btn btn-default"
                                    on-release="{{setPrivate(false)}}">
                                    Public
                                </button>
                                <button id="btn-private" data-toggle="tooltip" data-placement="auto"
                                    title='{{"rightsPermissionsPrivate" | translate}}' type="submit"
                                    class="btn btn-default active" on-release="{{setPrivate(true)}}">
                                    Private
                                </button>
                                <input type="text" ng-model="datadescriptor.license_permission"/>
                              </div>
                              -->
                              <!-- <br />
                              <br />
                            </div>-->
                          </div>
                        </div>
                      </div>   

                      <div class="panel panel-default"  ng-show="!wizardSecondPage">
                          <div class="panel-heading"><button class="btn btn-block" data-toggle="collapse" data-target="#hawaiian">Fields for Hawaiian Language group only</button></div>
                          <div id="hawaiian" class="panel-body collapse">
                            <div class="form-group">

                              <!-- Newspapers -->
                              <div class="form-group required"  ng-show="!wizardSecondPage">
                                  <label class="control-label pull-left" for="newspaper" data-toggle="tooltip" title='{{"newspaper" | translate}}'>Newspaper(s):</label>
                                  <button type="button" data-toggle="popover" title="Newspaper Field" data-content='{{"newspaper" | translate}}' class="btn btn-info btn-circle pull-left">
                                    <i class="glyphicon glyphicon-question-sign"></i>
                                  </button>
                                  <br />
                                  <ui-select
                                    class="form-control"
                                    multiple
                                    remove-selected="false"
                                    ng-model="datadescriptor.newspapers"
                                    theme="bootstrap"
                                    style="width: 100%;text-align: left;"
                                    sortable="true"
                                    ng-disabled="disabled"
                                    title="Choose newspapers">
                                    <ui-select-match placeholder="Select newspaper(s)...">{{$item.name}}</ui-select-match>
                                    <ui-select-choices repeat="newspaper in newspapers | filter: $select.search | orderBy:'name'">
                                      <div><span ng-bind-html="newspaper.name"></span></div>
                                    </ui-select-choices>
                                  </ui-select>
                                  <!-- JEN TODO later-->
                                  <!--<button type="button" class="fa fa-plus pull-right btn btn-default" ng-click="openCreateNewspaper('lg')">Create New Newspaper</button>-->
                                  <script>
                                    $(document).ready(function(){
                                        $('[data-toggle="popover"]').popover();
                                    });
                                  </script>
                                </div>

                              <!-- Authors -->
                              <div class="form-group required"  ng-show="!wizardSecondPage">
                                  <label class="control-label pull-left" for="articleAuthor" data-toggle="tooltip" title='{{"author" | translate}}'>Author(s):</label>
                                  <button type="button" data-toggle="popover" title="Author Field" data-content='{{"author" | translate}}' class="btn btn-info btn-circle pull-left">
                                    <i class="glyphicon glyphicon-question-sign"></i>
                                  </button>
                                  <br />
                                  <ui-select
                                    class="form-control"
                                    multiple
                                    remove-selected="false"
                                    ng-model="datadescriptor.articleAuthors"
                                    theme="bootstrap"
                                    style="width: 100%;text-align: left;"
                                    sortable="true"
                                    ng-disabled="disabled"
                                    title="Choose author(s)">
                                    <ui-select-match placeholder="Select author(s)...">{{$item.name}}</ui-select-match>
                                    <ui-select-choices repeat="author in articleAuthors | filter: $select.search | orderBy:'name'">
                                      <div><span ng-bind-html="author.name"></span><span ng-bind-html="author.pen_name"></span></div>
                                    </ui-select-choices>
                                  </ui-select>
                                  <!-- JEN TODO later-->
                                  <!--<button type="button" class="fa fa-plus pull-right btn btn-default" ng-click="openCreateAuthor('lg')">Create New Author</button>-->
                                  <script>
                                    $(document).ready(function(){
                                        $('[data-toggle="popover"]').popover();
                                    });
                                  </script>
                                </div>

                              <!-- Translators -->
                              <div class="form-group required"  ng-show="!wizardSecondPage">
                                <label class="control-label pull-left" for="translator" data-toggle="tooltip" title='{{"translator" | translate}}'>Translator(s):</label>
                                <button type="button" data-toggle="popover" title="Author Field" data-content='{{"translator" | translate}}' class="btn btn-info btn-circle pull-left">
                                  <i class="glyphicon glyphicon-question-sign"></i>
                                </button>
                                <br />
                                <ui-select
                                  class="form-control"
                                  multiple
                                  remove-selected="false"
                                  ng-model="datadescriptor.translators"
                                  theme="bootstrap"
                                  style="width: 100%;text-align: left;"
                                  sortable="true"
                                  ng-disabled="disabled"
                                  title="Choose translators">
                                  <ui-select-match placeholder="Select translator(s)...">{{$item.last_name}}, {{$item.first_name}}</ui-select-match>
                                  <ui-select-choices repeat="person in people | filter: $select.search | orderBy:'last_name'">
                                    <div><span ng-bind-html="person.last_name"></span>, <span ng-bind-html="person.first_name"></span></div>
                                  </ui-select-choices>
                                </ui-select>
                                <!-- JEN TODO later-->
                                <!--<button type="button" class="fa fa-plus pull-right btn btn-default" ng-click="openCreatePerson('lg')">Create New Translator</button>-->
                                <script>
                                  $(document).ready(function(){
                                      $('[data-toggle="popover"]').popover();
                                  });
                                </script>
                              </div>
                            </div>
                        </div>
                      </div>   



                            <!-- SUBJECT -->
                            <div class="form-group"  ng-show="!wizardSecondPage">
                              <label class="control-label pull-left" for="subject" data-toggle="tooltip" title='{{"subject" | translate}}'>Subject/Keywords/Search terms:</label>
                              <button type="button" data-toggle="popover" title="Subject Field" data-content='{{"subject" | translate}}' class="btn btn-info btn-circle pull-left">
                                <i class="glyphicon glyphicon-question-sign"></i>
                              </button>
                              <br />
                              <!--<input ng-model="datadescriptor.subjects" class="form-control" type='textarea' rows="2" placeholder="Enter Keywords"/>-->
                              <ui-select class="form-control"
                                multiple tagging tagging-label=""
                                remove-selected="false"
                                ng-model="datadescriptor.subjects"
                                theme="bootstrap"
                                style="width: 100%;text-align: left;"
                                sortable="true"
                                ng-disabled="disabled"
                                title="Choose subjects">
                                <ui-select-match placeholder="Enter terms you would use to search for this data...">{{$item}}</ui-select-match>
                                <ui-select-choices repeat="subject in subjects | filter: $select.search">
                                  <span ng-bind-html="subject"></span>
                                </ui-select-choices>
                              </ui-select>
                               <!--
                              <br />
                              <ui-select class="form-control" multiple tagging tagging-label="" remove-selected="false" ng-model="datadescriptor.subjects" theme="bootstrap" sortable="true" ng-disabled="disabled"  title="Choose subjects">
                                <ui-select-match placeholder="Enter terms you would use to search for this data...">{{$item.word}}</ui-select-match>
                                <ui-select-choices repeat="subject in subjects | filter: $select.search | orderBy:'subject.full_heirarchy'">
                                  <div ng-show='subject.display == "bold"'>
                                    <div><small><bold><span ng-bind-html="subject.word | highlight: subject.word"></span><bold></small></div>
                                  </div>
                                  <div ng-show='subject.display !== "bold"'>
                                    <div><small><span ng-bind-html="subject.word"></span></small></div>
                                  </div>
                                </ui-select-choices>
                              </ui-select>
                              -->
                              <!--
                              <small>
                                {{subject.short_heirarchy}}
                              </small>
                              -->
				                      <!-- <p>Selected: {{selected.people}}</p> -->
                            </div>

                             <!-- START DATE -->
                            <div class="form-group"  ng-show="!wizardSecondPage">
                              <label class="control-label pull-left" for="startDate" data-toggle="tooltip" title='{{"dates" | translate}}'>Data Collection Start Date:</label>
                              <button type="button" data-toggle="popover" title="Start Date Field" data-content='{{"dates" | translate}}' class="btn btn-info btn-circle pull-left">
                                <i class="glyphicon glyphicon-question-sign"></i>
                              </button>
                              <br />
                            </div>
                            <div class="form-group"  ng-show="!wizardSecondPage">
                              <div class='input-group date' id='datetimepicker1' data-provide="datepicker" data-date-format="yyyy-mm-dd" data-date="datadescriptor.start_datetime | date:'yyyy-mm-dd'">
                                  <input ng-model="datadescriptor.start_datetime"  min-date="new Date('1900-01-01')" type='text' class="form-control" width="50%" placeholder="Select start date of work referenced in file…"/>
                                  <span class="input-group-addon">
                                      <span class="glyphicon glyphicon-calendar"></span>
                                  </span>
                              </div>
                            </div>

                             <!-- END DATE -->
                            <div class="form-group"  ng-show="!wizardSecondPage">
                              <label class="control-label pull-left" for="endDate" data-toggle="tooltip" title='{{"dates" | translate}}'>Data Collection End Date:</label>
                              <button type="button" data-toggle="popover" title="End Date Field" data-content='{{"dates" | translate}}' class="btn btn-info btn-circle pull-left">
                                <i class="glyphicon glyphicon-question-sign"></i>
                              </button>
                              <br />
                            </div>
                            <div class="form-group"  ng-show="!wizardSecondPage">
                              <div class='input-group date' id='datetimepicker2' data-provide="datepicker" data-date-format="yyyy-mm-dd" data-date="datadescriptor.end_datetime">
                                <input type='text' ng-model="datadescriptor.end_datetime" min-date="new Date('1900-01-01')" class="form-control" value="datadescriptor.end_datetime" placeholder="Select end date of work referenced in file…"/>
                                <span class="input-group-addon">
                                  <span class="glyphicon glyphicon-calendar"></span>
                                </span>
                              </div>
                            </div>

                           <div class="form-group"  ng-show="!wizardSecondPage" align="left">
                            <label class="control-label" for="sensitive" data-toggle="tooltip" title='{{"sensitive" | translate}}'>Can this data be made available to the general public?:</label>
                            <button type="button" data-toggle="popover" title="State Field" data-content='{{"sensitive" | translate}}' class="btn btn-info btn-circle">
                                <i class="glyphicon glyphicon-question-sign"></i>
                              </button>
                            <br />
                            <input type="radio" value="Public" name="sensitive" ng-model="datadescriptor.sensitive" > Public &nbsp;&nbsp;&nbsp;
                            <input type="radio" value="Private" name="sensitive" ng-model="datadescriptor.sensitive" > Private &nbsp;&nbsp;&nbsp;                        
                          </div><br />

                            <!-- DATA TYPE -->
                              <div class="form-group"  ng-show="!wizardSecondPage">
                              <label class="control-label pull-left" for="data_types" data-toggle="tooltip" title='{{"data_types" | translate}}'>Data Type:</label>
                              <button type="button" data-toggle="popover" title="Data Type Field" data-content='{{"data_types" | translate}}' class="btn btn-info btn-circle pull-left">
                                <i class="glyphicon glyphicon-question-sign"></i>
                              </button>
                              <br />
                              <ui-select class="form-control"
                                multiple tagging tagging-label=""
                                remove-selected="false"
                                ng-model="datadescriptor.data_types"
                                theme="bootstrap"
                                style="width: 100%;text-align: left;"
                                sortable="true"
                                ng-disabled="disabled"
                                title="Choose data types">
                                <ui-select-match placeholder="Select file data type(s)...">{{$item}}</ui-select-match>
                                <ui-select-choices repeat="data_type in data_types | filter: $select.search">
                                  <span ng-bind-html="data_type"></span>
                                </ui-select-choices>
                              </ui-select>
                            </div>
                            
                             <!-- FORMAT -->
                            <div class="form-group"  ng-show="!wizardSecondPage">
                              <label class="control-label pull-left" for="format" data-toggle="tooltip" title='{{"format" | translate}}'>Format:</label>
                              <button type="button" data-toggle="popover" title="Format Field" data-content='{{"format" | translate}}' class="btn btn-info btn-circle pull-left">
                                <i class="glyphicon glyphicon-question-sign"></i>
                              </button>
                              <br />
                              <ui-select class="form-control"
                                multiple tagging tagging-label=""
                                remove-selected="false"
                                ng-model="datadescriptor.formats"
                                theme="bootstrap"
                                style="width: 100%;text-align: left;"
                                sortable="true"
                                ng-disabled="disabled"
                                title="Choose formats">
                                <ui-select-match placeholder="Select file format(s)...">{{$item}}</ui-select-match>
                                <ui-select-choices repeat="format in formats | filter: $select.search">
                                  <span ng-bind-html="format"></span>
                                </ui-select-choices>
                              </ui-select>
                            </div>

                            <!-- LANGUAGE -->
                            <!--
                            <div class="form-group">
                              <label class="control-label pull-left" for="language" data-toggle="tooltip" title='{{"language" | translate}}'>Languages:</label>
                              <button type="button" data-toggle="popover" title="Languages Field" data-content='{{"language" | translate}}' class="btn btn-info btn-circle pull-left">
                                <i class="glyphicon glyphicon-question-sign"></i>
                              </button>
                              <br />
                              <ui-select class="form-control" multiple tagging tagging-label="" remove-selected="false" ng-model="datadescriptor.languages" theme="bootstrap" sortable="true" ng-disabled="disabled"  title="Choose languages">
                                <ui-select-match placeholder="Select languages...">{{$item}}</ui-select-match>
                                <ui-select-choices repeat="language in languages | filter: $select.search">
                                  <span ng-bind-html="language"></span>
                                </ui-select-choices>
                              </ui-select>
                            </div>
                            -->

                            <!-- VERSION -->
                            <!--
                            <div class="form-group">
                              <label class="control-label pull-left" for="version" data-toggle="tooltip" title='{{"version" | translate}}'>Version:</label>
                              <button type="button" data-toggle="popover" title="Version Field" data-content='{{"version" | translate}}' class="btn btn-info btn-circle pull-left">
                                <i class="glyphicon glyphicon-question-sign"></i>
                              </button>
                              <input ng-model="datadescriptor.version" class="form-control" type='text'/>
                            </div>
                            -->
  	                        <!--<div id="association_notifications"></div>-->
                              <!-- DESCRIPTION -->
                            <div class="form-group" ng-show="!wizardSecondPage">
                              <label class="control-label pull-left" for="descriptor" data-toggle="tooltip" title='{{"descriptor" | translate}}'>Summary:</label>
                              <button type="button" data-toggle="popover" title="Description Field" data-content='{{"descriptor" | translate}}' class="btn btn-info btn-circle pull-left">
                                <i class="glyphicon glyphicon-question-sign"></i>
                              </button>
                              <textarea ng-model="datadescriptor.description" placeholder="Enter abstract or text describing this resource" class="form-control" type='textarea' rows="5"/>
                            </div>

                            <!-- CHOOSE LOCATIONS -->
                            <div class="form-group" ng-show="data_descriptor_metadatum">
                              <button type="button" class="btn btn-success pull-left form-control" ng-click="openLocations('lg' ,['Well','Site','Water_Quality_Site','RainfallStation'],'Select Location(s)')">Select Location(s)</button>
                            </div>
                            <div id="location_buttons">
                              <button type="button" class="btn btn-default btn-sm"  ng-repeat="filemetadatum in locations" ng-click="unAssociateMetadata(filemetadatum.uuid,'#association_notifications')">
                                {{filemetadatum.value.well_name}}{{filemetadatum.value.name}}{{filemetadatum.value.title}}
                                {{filemetadatum.value.wid}} {{filemetadatum.value.variable_name}} {{filemetadatum.value.description}} {{filemetadatum.value.tags.toString()}}
                                <i id="filemetadatum.uuid" ng-class="class[uuid]" class="glyphicon glyphicon-remove-sign"></i>
                              </button>
                            </div></br></br></br>

                            <!-- CHOOSE VARIABLES -->
                            <div class="form-group" ng-show="data_descriptor_metadatum">
                              <button type="button" class="btn btn-success pull-left form-control" ng-click="openVariables('lg',['Variable'],'Select Variable(s)')">Select Variable(s)</button>
                            </div>
                            <div id="variable_buttons">
                              <button type="button" class="btn btn-default btn-sm" ng-repeat="filemetadatum in variables | filter: {name:'Variable'}" ng-click="unAssociateMetadata(filemetadatum.uuid,'#association_notifications')">
                                {{filemetadatum.value.well_name}}{{filemetadatum.value.name}}{{filemetadatum.value.title}}
                                {{filemetadatum.value.wid}} {{filemetadatum.value.variable_name}} {{filemetadatum.value.description}} {{filemetadatum.value.tags.toString()}}
                                <i class="glyphicon glyphicon-remove-sign"></i>
                              </button>
                            </div></br></br>

                            <!-- PUBLISHER -->
                            <!--
                            <div class="form-group">
                              <label class="control-label pull-left" for="descriptor" data-toggle="tooltip" title='{{"publisher" | translate}}'>Publisher:</label>
                              <button type="button" data-toggle="popover" title="Publisher Field" data-content='{{"publisher" | translate}}' class="btn btn-info btn-circle pull-left">
                                <i class="glyphicon glyphicon-question-sign"></i>
                              </button>
                                <ui-select class="form-control" multiple remove-selected="false" ng-model="datadescriptor.publisher" theme="bootstrap" sortable="true" ng-disabled="disabled"  title="Choose contributing people">
                                <ui-select-match placeholder="Enter publishing organization(s)…">{{$item.name}}</ui-select-match>
                                <ui-select-choices repeat="org in orgs | filter: $select.search">
                                  <span ng-bind-html="org.name"></span>
                                </ui-select-choices>
                              </ui-select>
                            </div>
                            -->
                            <!--<input ng-model="datadescriptor.publisher" class="form-control" type='textarea' rows="2" placeholder=" Enter publishing organization(s)…"/>-->

                            <!-- PUBLICATION DATE -->
                            <!--
                            <div class="form-group">
                              <label class="control-label pull-left" for="publicationDate" data-toggle="tooltip" title='{{"publicationDate" | translate}}'>Date of Publication:</label>
                              <button type="button" data-toggle="popover" title="Publication Date Field" data-content='{{"publicationDate" | translate}}' class="btn btn-info btn-circle pull-left">
                                <i class="glyphicon glyphicon-question-sign"></i>
                              </button>
                              <br />
                            </div>
                            <div class="form-group">
                              <div class='input-group date' id='datetimepicker3' data-provide="datepicker">
                                <input ng-model="datadescriptor.publication_date"  type='text' class="form-control" placeholder="Select date of publication…"/>
                                <span class="input-group-addon">
                                   <span class="glyphicon glyphicon-calendar"></span>
                                </span>
                              </div>
                            </div>
                            -->





                            <!-- copied from app/views/systems/wizard.html -->
                              <!--
                              <ui-select ng-model="systemTemplate" theme="bootstrap" on-select="changeSystemTemplate($item)">
				                <ui-select-match placeholder="Search...">{{$select.selected.id}}</ui-select-match>
				                <ui-select-choices repeat="system in systemTemplates | filter: $select.search">
				                  <div ng-bind-html="system.name"></div>
				                  <div ng-bind-html="system.id"></div>
				                  <div ng-bind-html="system.type"></div>
				                </ui-select-choices>
				              </ui-select>
				               -->

                            <!--
                            <div class="panel-group" id="accordion">
                              <div class="panel panel-default">
                                <div class="panel-heading">
                                  <h4 class="panel-title">
                                    <a href="javascript:;" data-toggle="collapse" data-parent="#accordion" data-target="#collapseOne">
                                      Optional
                                    </a>
                                  </h4>
                                </div>
                                <div id="collapseOne" class="panel-collapse collapse">
                                  <div class="panel-body">

                                    <div class="form-group">
                                      <label class="control-label pull-left" for="Title">Project Type</label><button type="button" class="btn btn-info btn-circle pull-left" data-toggle="popover" title="Title Field" data-content="The title of this data object."><i class="glyphicon glyphicon-question-sign"></i></button>
                                      <input ng-model="datadescriptor.project_type" class="form-control" type="text"/>
                                    </div>
                                    <div class="form-group">
                                      <label class="control-label pull-left" for="Title">Funding Agency And Award Number</label><button type="button" class="btn btn-info btn-circle pull-left" data-toggle="popover" title="Title Field" data-content="The title of this data object."><i class="glyphicon glyphicon-question-sign"></i></button>
                                      <input ng-model="datadescriptor.funding_agency" class="form-control" type="text"/>
                                    </div>
                                    <div class="form-group">
                                      <label class="control-label pull-left" for="Title">Participant Institution:</label><button type="button" class="btn btn-info btn-circle pull-left" data-toggle="popover" title="Title Field" data-content="The title of this data object."><i class="glyphicon glyphicon-question-sign"></i></button>
                                      <input ng-model="datadescriptor.institution" class="form-control" type="text" value="University of Hawaii"/>
                                    </div>

                                  </div>
                                </div>
                              </div>
                            </div>
                             -->
                            <!--<div ng-if="ddUuid === ''"class="form-group"> -->
                              <!--
                            <div ng-if="has_data_descriptor == false"class="form-group">
                              <button  class="btn btn-primary" type="submit"  ng-click="saveDataDescriptor()" >Save Data Descriptor</button>
                            </div>

                            <div ng-if="has_data_descriptor == true"class="form-group">
                              <button  class="btn btn-primary" type="submit"  ng-click="updateDataDescriptor()" >Save Changes</button>
                            </div>
                            -->
                          </div>
                          </form>
                          </div>
                        </div>
                      </div>

                    </div>
                  </div>
              </div>
            </div>
        </div>
    </div>
</div>
<div class="modal-footer">
    <button class="btn btn-default pull-left" ng-click="close()">Close</button>
    <!-- <button class="btn btn-primary" ng-click="submit()">Submit</button> -->
    <div ng-if="has_data_descriptor == false" class="form-group">
      <button type="button" class="btn btn-primary" type="submit"  ng-click="saveDataDescriptor('#data_descriptor_modal')" >Save and go to step 2...</button>
    </div>
    <!--<div ng-if="ddUuid != ''"class="form-group"> -->

    <div ng-if="wizardSecondPage && has_data_descriptor == true && edit_data_descriptor == true" class="form-group">
        <button type="button" class="btn btn-primary" type="submit"  ng-click="updateDataDescriptor('#data_descriptor_modal')" >Finish</button>
    </div>

    <div ng-if="!wizardSecondPage && has_data_descriptor == true && edit_data_descriptor == true" class="form-group">
      <button type="button" class="btn btn-primary" type="submit"  ng-click="updateDataDescriptor('#data_descriptor_modal')" >Save</button>
    </div>
</div>
